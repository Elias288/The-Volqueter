pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
function _init()
	player={
		spb=3,   --sprite bernie
		spc=1,   --sprite carroza
		x=0,
		y=4,
		h=16,
		w=16,
		dx=0,
		dy=0,
		flp=false,
		acc=0.5,  --aceleracion
		boost=4,  --salto
		junmping=false,
		landed=false,
		falling=false
	}

	gravity=0.3
	friccion=0.85

	tiempo=0
	
	palt(0, false)
    palt(7, true)
end

function _update()
 	tiempo += 1

	player_update()
end

function _draw()
	cls()
	
	camera(0,0)
	map()
	dibujar(player.spb, player.x, player.y)
	--caminar(50, 35)
end

-->8
function dibujar (k, x, y)
	sspr(
		(k % 16)*8, 
		(k \ 16)*8,
		16, 
		16, 
		x, 
		y
	)
		
end

function ataque1(x, y)
	if tiempo%10 < 5 then
		dibujar(35, x, y)
	else
		dibujar(37, x, y)
	end
end

function caminar(x, y)
	if tiempo %20 < 10 then
		dibujar(1, x-16, y)
		dibujar(3, x, y)
	else
		dibujar(33, x-16, y)
		dibujar(5, x, y)
	end
end

function player_update()
	--physics
	player.dy+=gravity
	player.dx*=friccion

	--controls
	if btn(➡️) then
		player.dx+=player.acc
	end
	if btn(❎) and player.landed then
		player.dy-=player.boost
		player.landed=false
	end
	if btn(⬅️) then
		player.dx-=player.acc
	end
	
	if player.dy>0 then
		player.falling=true
		player.landed=false
		player.junmping=false
		
		if map_collide(player, "down", 0) then
			player.landed=true
			player.falling=false
			player.dy=0
			player.y-=(player.y+player.h)%8
		end
	elseif player.dy<0 then
		player.junmping=true
		if map_collide(player, "up", 1) then
			player.dy=0
		end
	end

	if player.dx<0 then
		if map_collide(player, "left", 1) then
			player.dx=0
		end
	elseif player.dx>0 then
		if map_collide(player, "right", 1) then
		 	player.dx=0
		end
	end

	player.x+= player.dx
	player.y+= player.dy

end
-->8
function map_collide(obj, dir, flag)
	local x=obj.x
	local y=obj.y
	local h=obj.h
	local w=obj.w

	local x1=0 local y1=0
	local x2=0 local y2=0

	if dir=="left" then
		x1=x-1 
		x2=x 
		y1=y
		y2=y+h-1
	elseif dir=="right" then
		x1=x+w 
		x2=x+w+1
		y1=y 
		y2=y+h-1
	elseif dir=="up" then
		x1=x+1
		x2=x+w-1
		y1=y-1
		y2=y
	elseif dir=="down" then
		x1=x 
		x2=x+w
		y1=y+h
		y2=y+h
	end

	--pixels to tiles
	x1/=8
	x2/=8
	y1/=8
	y2/=8

	if fget(mget(x1,y1), flag)
	or fget(mget(x1,y2), flag)
	or fget(mget(x2,y1), flag)
	or fget(mget(x2,y2), flag) then
		return true
	else
		return false
	end
end

__gfx__
00000000777777777777777777777777777777777777777777777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777777771117777777777777111777777777000000000000000000000000000000000000000000000000000000000000000000000000
00700700777777777777777777711111777777777771111177777777000000000000000000000000000000000000000000000000000000000000000000000000
00077000777777777777777777711111117777777771111111777777000000000000000000000000000000000000000000000000000000000000000000000000
0007700077777777777777777777ff64777777777777ff6477777777000000000000000000000000000000000000000000000000000000000000000000000000
0070070077777777777777777777fffff77777777777fffff7777777000000000000000000000000000000000000000000000000000000000000000000000000
0000000077777777777777777777ffff777777777777ffff77777777000000000000000000000000000000000000000000000000000000000000000000000000
0000000074777777777777777777ccc3777777777777ccc377777777000000000000000000000000000000000000000000000000000000000000000000000000
000000007447777777777777777ccc3377777777777ccc3377777777000000000000000000000000000000000000000000000000000000000000000000000000
0000000074444666444477444fccc333cff777774fccc33377777777000000000000000000000000000000000000000000000000000000000000000000000000
000000007444666664444444ffcc3333cff77777ffcc333377777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000744666066644444777773333777777777777333377777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000744666466644447777777557777777777777555577777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000744666066644477777777557777777777775555557177777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777766666777777777777117777777777715577551177777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777776667777777777777111777777777711177711777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777777777777777777777777777777777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777777771117777777777777111777777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777777711111777777777771111177777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777777711111117777777771111111777777000000000000000000000000000000000000000000000000000000000000000000000000
0000000077777777777777777777ff74777777777777ff6477777777000000000000000000000000000000000000000000000000000000000000000000000000
0000000077777777777777777777fffff77777777777fffff7777777000000000000000000000000000000000000000000000000000000000000000000000000
0000000074777777777777777777ffff777777777777ffff77777777000000000000000000000000000000000000000000000000000000000000000000000000
0000000074477777777777777777ccc3777777777777ccc377777777000000000000000000000000000000000000000000000000000000000000000000000000
000000007444444444477777777ccc3347777777777ccc3377477777000000000000000000000000000000000000000000000000000000000000000000000000
0000000074444666444444444fccc333477777774fccc333ff477777000000000000000000000000000000000000000000000000000000000000000000000000
000000007444666664444444ffcc333347777777ffcc3333ff477777000000000000000000000000000000000000000000000000000000000000000000000000
00000000744666666644447777773333477777777777333377477777000000000000000000000000000000000000000000000000000000000000000000000000
00000000744660406644477777777557777777777777755777777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777666666677777777777557777777777777755777777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777766666777777777777117777777777777711777777777000000000000000000000000000000000000000000000000000000000000000000000000
00000000777776667777777777777111777777777777711177777777000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000dd000000000000dd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000d00000000000000d000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05555000005550050005555000050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55505550055555500055555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555555555550555055550555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555555505550555555555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55055555550555555555555555550550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555555555555555505555555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555505dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05555555dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55550555dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55505555dddddddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000101000000010101000000000000000001010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003030303000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
5151515151515151515151515151515100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5151515151515151515151515151515100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5151515151515151515151515151515100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5151515151515151424040435151515100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5151515151515142505050504351515100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4141404140404050505050505040404000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5050505050505050505050505050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5050505050505050505050505050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5050505050505050505050505050505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
